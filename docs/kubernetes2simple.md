# kubernetes2simple

> *The disciple came to the temple seeking passage. "I wish to cross," he said, "but I do not wish to understand." The priests exchanged a glance. They had built an entire wing for this.*
>
> — *Necronomicon, On Blessed Ignorance (understandably)*

*Kubernetes? Too simple.*

Also known as **k2s** — not to be confused with [K2s](https://github.com/Siemens-Healthineers/K2s) (uppercase), the Siemens Healthineers Kubernetes distribution for Windows. Different project, same cosmic arrogance.

kubernetes2simple is a turnkey distribution built on top of [helmfile2compose](index.md) — the conversion engine + all official extensions, bundled into a single script with a zero-config bootstrap. You don't need to know what helmfile2compose is to use this. You don't need to know what an extension is. You just run it.

You have a Kubernetes project — a helmfile, a Helm chart, or just a pile of YAML. You want `docker compose up -d`. You don't want to install anything, configure anything, or learn anything.

```bash
curl -fsSL https://raw.githubusercontent.com/helmfile2compose/kubernetes2simple/main/kubernetes2simple.sh -o k2s.sh
chmod +x k2s.sh
./k2s.sh
docker compose up -d
```

That's it.

## What happens

The script looks at your current directory and figures out what you have:

| It finds | It does |
|---|---|
| `helmfile.yaml` | Renders via helmfile, then converts |
| `Chart.yaml` | Renders via helm, then converts |
| `*.yaml` with K8s manifests | Converts directly |
| Nothing recognizable | Tells you, politely |

Then it installs whatever's missing — Python dependencies, helm, helmfile — into a `.kubernetes2simple/` directory that stays in your project. Your system is never touched. Add `.kubernetes2simple/` to your `.gitignore` and forget about it.

The output is a `compose.yml`, a `Caddyfile`, and a `helmfile2compose.yaml` configuration file.

## A few things worth knowing

**You can re-run safely.** `compose.yml` and `Caddyfile` are regenerated every time — don't edit them by hand. To customize things (exclude a service, override an image, pin a volume path), edit `helmfile2compose.yaml`. That file is yours; the script reads it but never overwrites it.

**TLS is best-effort.** If your project uses cert-manager, the script generates self-signed certificates locally so services can start. This is fine for development. It is not real TLS — don't ship it expecting production certificates.

**Some things won't convert.** CronJobs, resource limits, HPA, probes — anything without a compose equivalent is skipped with a warning. The goal is a working local environment, not a replica of your cluster.

## Options

```
./k2s.sh [--env <environment>] [--output-dir <dir>] [--clean]
```

| Flag | What it does |
|---|---|
| `--env`, `-e` | Helmfile environment to render (helmfile mode only) |
| `--output-dir` | Where to write the output (default: current directory) |
| `--clean` | Wipe `.kubernetes2simple/` and start fresh |

## Prerequisites

- Docker (with `docker compose`)
- Python 3.10+
- curl
- Internet access on first run

Everything else is handled.

## FAQ

### Services can't reach each other

Services talk to each other using K8s DNS names (`svc.namespace.svc.cluster.local`). These are mapped as Docker network aliases. If you're using **nerdctl compose** (Rancher Desktop with containerd), aliases are silently ignored — switch to dockerd (moby) in Rancher Desktop settings, or install the `flatten-internal-urls` extension.

If you're using regular Docker Compose and services still can't connect: check `docker compose logs` for the failing service. The upstream hostname is usually in the error message. Run `docker compose exec <service> nslookup <hostname>` to verify DNS resolution.

### A service crashes on startup

Common causes:

- **Bitnami images** (Redis, PostgreSQL, Keycloak) — their custom entrypoints expect K8s-specific init containers and volume layouts. kubernetes2simple includes the `bitnami` transform, which handles the most common cases automatically. If a Bitnami service still fails, check [known workarounds](maintainer/known-workarounds/common-charts.md).
- **Missing secrets or configmaps** — the service expects data that was generated by a CRD controller at runtime (cert-manager certificates, trust-manager bundles). kubernetes2simple includes both extensions, but if the CRD isn't in your manifests, there's nothing to convert. Check the warnings printed during conversion.
- **Permission denied on volumes** — non-root containers can't write to bind mounts owned by root. The `fix-permissions` transform generates a busybox init service to fix this, but it only covers containers with an explicit `securityContext.runAsUser`. If yours doesn't declare one, add an `overrides:` entry in `helmfile2compose.yaml` with `user: "1000"` or the appropriate UID.

### The Caddyfile is empty / no routes

Your manifests don't contain `Ingress` resources, or the ingress class doesn't match any installed rewriter. kubernetes2simple includes HAProxy (default), nginx, and traefik rewriters. Check that your Ingress manifests have an `ingressClassName` that matches one of these, or that `helmfile2compose.yaml` maps the class name to a rewriter.

### CronJobs, HPA, probes are missing

By design. These have no compose equivalent. CronJobs would need an external scheduler, HPA needs metrics + scaling, probes need a health-check orchestrator. They're skipped with a warning. See [limitations](limitations.md) for the full list.

### I want to customize the output

Edit `helmfile2compose.yaml` — it's generated on first run and never overwritten. You can exclude services, override images, pin volume paths, add environment variables, configure the reverse proxy. See [configuration](maintainer/configuration.md) for the full reference.

### None of this helps

[Open an issue.](https://github.com/helmfile2compose/kubernetes2simple/issues) Paste the full script output. We'll figure it out — or at least commiserate.

---

## Into the abyss

kubernetes2simple is the surface. Underneath is [helmfile2compose](index.md) — a conversion engine with an extension system, a package manager, a fake API server, a regression suite with a torture generator, and documentation that you are currently reading.

If you want to understand what just happened to your YAML, you can start here:

- **[What gets converted and how](developer/architecture.md)** — the conversion pipeline, kind by kind
- **[Configuration deep dive](maintainer/configuration.md)** — everything `helmfile2compose.yaml` can do
- **[Available extensions](catalogue.md)** — Keycloak, cert-manager, Prometheus, Bitnami workarounds, and more
- **[Limitations](limitations.md)** — what doesn't cross the bridge, and why
- **[About](about.md)** — the full, unhinged story of how this happened

You were warned.
